#!/bin/bash
# Git-related utility functions

set -euo pipefail

fetch_git_history() {
    echo "Fetching git history..."
    git fetch --unshallow || true
}

fetch_pr_references() {
    if [ -n "${GITHUB_BASE_BRANCH:-}" ]; then
        echo "Fetching PR references for base branch: $GITHUB_BASE_BRANCH"
        git fetch origin "${GITHUB_BASE_BRANCH}"
    fi
}

is_master_branch() {
    echo "Checking if current branch is master: $GITHUB_BRANCH"
    [[ "${GITHUB_BRANCH}" == "master" ]]
}

is_maintenance_branch() {
    echo "Checking if current branch is a maintenance branch: $GITHUB_BRANCH"
    [[ "${GITHUB_BRANCH}" == "branch-"* ]]
}

is_pull_request() {
    echo "Checking if this is a pull request: ${PULL_REQUEST:-}"
    [[ "${PULL_REQUEST:-}" != "false" ]]
}

is_dogfood_branch() {
    echo "Checking if current branch is a dogfood branch: $GITHUB_BRANCH"
    [[ "${GITHUB_BRANCH}" == "dogfood-on-"* ]]
}

is_long_lived_feature_branch() {
    echo "Checking if current branch is a long-lived feature branch: $GITHUB_BRANCH"
    [[ "${GITHUB_BRANCH}" == "feature/long/"* ]]
}
